
param Vnom := 13.8;
param Barra_SE := 0;



param : Ob :          PD           QD         QC      Vini :=   
          0       0.0000     0.0000       0.0000     13.8000 
          1       0.0000     0.0000       0.0000     13.6754 
          2      47.7800    19.0090       0.0000     13.6747 
          3      42.5510    16.9290       0.0000     13.5931 
          4      87.0220    34.6220       0.0000     13.5574 
          5     311.3100   123.8550       0.0000     13.5037 
          6     148.8690    59.2280       0.0000     13.4548 
          7     238.6720    94.9560       0.0000     13.4509 
          9      62.2990    24.7860       0.0000     13.4448 
         10     124.5980    49.5710       0.0000     13.4389 
         12     140.1750    55.7680       0.0000     13.4276 
         13     116.8130    46.4740       0.0000     13.4234 
         15     249.2030    99.1450       0.0000     13.4082 
         17     291.4470   115.9520       0.0000     13.4152 
         18     303.7200   120.8350       0.0000     13.4014 
         20     215.3960    85.6950       0.0000     13.4127 
         21     198.5860    79.0070       0.0000     13.4075 
         24       0.0000     0.0000       0.0000     13.6799 
         25       0.0000     0.0000       0.0000     13.6793 
         26       0.0000     0.0000       0.0000     13.5989 
         27      30.1270    14.7290       0.0000     13.5599 
         28     230.9720   112.9200       0.0000     13.5447 
         29      60.2560    29.4580       0.0000     13.5023 
         30     230.9720   112.9200       0.0000     13.4958 
         32     120.5070    58.9150       0.0000     13.4957 
         33       0.0000     0.0000       0.0000     13.4844 
         34      56.9810    27.8570       0.0000     13.4797 
         35     364.6650   178.2810       0.0000     13.4597 
         36       0.0000     0.0000       0.0000     13.4566 
         37     124.6470    60.9390       0.0000     13.4534 
         38      56.9810    27.8570       0.0000     13.4513 
         39       0.0000     0.0000       0.0000     13.4505 
         40      85.4730    41.7870       0.0000     13.4462 
         41       0.0000     0.0000       0.0000     13.4307 
         42     396.7350   193.9600       0.0000     13.4265 
         43       0.0000     0.0000       0.0000     13.4463 
         44     181.1520    88.5630       0.0000     13.4316 
         45     242.1720   118.3950       0.0000     13.4256 
         46      75.3160    36.8210       0.0000     13.4458 
         48       0.0000     0.0000       0.0000     13.6737 
         49       1.2540     0.5310       0.0000     13.6290 
         50       6.2740     2.6600       0.0000     13.6275 
         51       0.0000     0.0000       0.0000     13.6283 
         52     117.8800    49.9710       0.0000     13.6022 
         53      62.6680    26.5660       0.0000     13.5976 
         54     172.2850    73.0340       0.0000     13.5799 
         55     458.5560   194.3880       0.0000     13.5374 
         56     262.9620   111.4730       0.0000     13.5216 
         57     235.7610    99.9420       0.0000     13.5005 
         58       0.0000     0.0000       0.0000     13.4972 
         59     109.2150    46.2980       0.0000     13.4939 
         61       0.0000     0.0000       0.0000     13.4945 
         62      72.8090    30.8650       0.0000     13.4910 
         63     258.4730   109.5700       0.0000     13.4879 
         64      69.1690    29.3220       0.0000     13.4875 
         65      21.8430     9.2600       0.0000     13.4874 
         67       0.0000     0.0000       0.0000     13.4832 
         68      20.5270     8.7020       0.0000     13.4720 
         69     150.5480    63.8190       0.0000     13.4544 
         70     220.6870    93.5520       0.0000     13.4401 
         71      92.3840    39.1630       0.0000     13.4373 
         72       0.0000     0.0000       0.0000     13.4373 
         73     226.6930    96.0980       0.0000     13.5169 
         75       0.0000     0.0000       0.0000     13.7983 
         76     294.0160   116.9740       0.0000     13.7384 
         77      83.0150    33.0280       0.0000     13.6696 
         78      83.0150    33.0280       0.0000     13.6144 
         80     103.7700    41.2850       0.0000     13.5635 
         81     176.4080    70.1840       0.0000     13.5396 
         82      83.0150    33.0280       0.0000     13.5354 
         83     217.9170    86.6980       0.0000     13.5336 
         84      23.2940     9.2670       0.0000     13.5318 
         85       5.0750     2.0190       0.0000     13.5313 
         86      72.6380    28.8990       0.0000     13.5290 
         87     405.9900   161.5230       0.0000     13.4837 
        121       0.0000     0.0000       0.0000     13.7972 
        122     100.1820    42.4680       0.0000     13.6191 
        123     142.5230    60.4170       0.0000     13.5678 
        124      96.0420    40.7130       0.0000     13.5249 
        125     300.4540   127.3660       0.0000     13.5159 
        127     141.2380    59.8730       0.0000     13.4501 
        128     279.8470   118.6310       0.0000     13.4190 
        129      87.3120    37.0130       0.0000     13.4145 
        130     243.8490   103.3710       0.0000     13.4134 
        131     247.7500   105.0250       0.0000     13.4005 
        133       0.0000     0.0000       0.0000     13.7954 
        134      89.8780    38.1010       0.0000     13.6248 
        135    1137.2800   482.1080       0.0000     13.6112 
        136     458.3390   194.2960       0.0000     13.5254 
        137     385.1970   163.2900       0.0000     13.5186 
        138       0.0000     0.0000       0.0000     13.5107 
        139      79.6080    33.7470       0.0000     13.4768 
        141      87.3120    37.0130       0.0000     13.4692 
        142       0.0000     0.0000       0.0000     13.4589 
        143      74.0010    31.3700       0.0000     13.4450 
        144     232.0500    98.3690       0.0000     13.4364 
        145     141.8190    60.1190       0.0000     13.4324 
        146       0.0000     0.0000       0.0000     13.4578 
        147      76.4490    32.4080       0.0000     13.4563 
        148       0.0000     0.0000       0.0000     13.7955 
        149      51.3220    21.7560       0.0000     13.7154 
        150      59.8740    25.3810       0.0000     13.6605 
        152       9.0650     3.8430       0.0000     13.6587 
        153       2.0920     0.8870       0.0000     13.4544 
        154      16.7350     7.0940       0.0000     13.1447 
        155    1506.5220   638.6340       0.0000     12.9565 
        156     313.0230   132.6940       0.0000     12.9281 
        157      79.8310    33.8420       0.0000     12.9063 
        158      51.3220    21.7560       0.0000     12.8824 
        159       0.0000     0.0000       0.0000     12.8695 
        160     202.4350    85.8150       0.0000     12.9047 
        162      60.8230    25.7840       0.0000     12.8999 
        163      45.6180    19.3380       0.0000     12.8961 
        164       0.0000     0.0000       0.0000     12.8961 
        200     157.0700    66.5840       0.0000     12.8708 
        201       0.0000     0.0000       0.0000     12.8708 
        202     250.1480   106.0410       0.0000     12.8433 
        203       0.0000     0.0000       0.0000     12.8433 
        204      69.8090    29.5930       0.0000     13.1368 
        205      32.0720    13.5960       0.0000     13.1347 
        206      61.0840    25.8940       0.0000     13.1336 
        207       0.0000     0.0000       0.0000     13.7964 
        208      94.6220    46.2600       0.0000     13.5896 
        209      49.8580    24.3750       0.0000     13.5760 
        210     123.1640    60.2140       0.0000     13.5704 
        211      78.3500    38.3040       0.0000     13.5703 
        212     145.4750    71.1210       0.0000     13.5631 
        214      21.3690    10.4470       0.0000     13.5470 
        215      74.7890    36.5640       0.0000     13.5456 
        217     227.9260   111.4310       0.0000     13.5159 
        218      35.6140    17.4110       0.0000     13.5078 
        219     249.2950   121.8770       0.0000     13.4910 
        220     316.7220   154.8420       0.0000     13.4680 
        221     333.8170   163.1990       0.0000     13.4436 
        222     249.2950   121.8770       0.0000     13.4326 
        223       0.0000     0.0000       0.0000     13.4326 
        ;

#-----------------------------------------------------------------------

param :            Ol: 	     linha    R   		  X            Imax :=
               0          1       1      0.332050   0.766530     1000
               1          2       2      0.001880   0.004330     1000
               2          3       3      0.223240   0.515350     1000
               3          4       4      0.099430   0.229530     1000
               4          5       5      0.155710   0.359450     1000
               5          6       6      0.163210   0.376770     1000
               6          7       7      0.114440   0.264170     1000
               6          9       8      0.056750   0.056660     1000
               9         10       9      0.521240   0.274180     1000
               9         12      10      0.108770   0.108600     1000
              12         13      11      0.398030   0.209370     1000
              12         15      12      0.917440   0.314690     1000
              12         17      13      0.118230   0.118050     1000
              17         18      14      0.502280   0.264210     1000
              17         20      15      0.056750   0.056660     1000
              20         21      16      0.293790   0.154540     1000
               0         24      17      0.332050   0.766530     1000
              24         25      18      0.001880   0.004330     1000
              25         26      19      0.223240   0.515350     1000
              26         27      20      0.108810   0.251180     1000
              27         28      21      0.710780   0.373880     1000
              27         29      22      0.181970   0.420080     1000
              29         30      23      0.303260   0.159520     1000
              29         32      24      0.024390   0.056300     1000
              32         33      25      0.045020   0.103940     1000
              33         34      26      0.018760   0.043310     1000
              34         35      27      0.118230   0.118050     1000
              35         36      28      0.023650   0.023610     1000
              36         37      29      0.189540   0.099700     1000
              37         38      30      0.398030   0.209370     1000
              36         39      31      0.056750   0.056660     1000
              39         40      32      0.094770   0.049850     1000
              40         41      33      0.416990   0.219340     1000
              41         42      34      0.113720   0.059820     1000
              39         43      35      0.075660   0.075550     1000
              43         44      36      0.369600   0.194420     1000
              44         45      37      0.265360   0.139580     1000
              43         46      38      0.056750   0.056660     1000
               0         48      39      0.332050   0.766530     1000
              48         49      40      0.118190   0.272830     1000
              49         50      41      2.962880   1.016280     1000
              49         51      42      0.001880   0.004330     1000
              51         52      43      0.069410   0.160240     1000
              52         53      44      0.815020   0.428720     1000
              52         54      45      0.063780   0.147240     1000
              54         55      46      0.131320   0.303150     1000
              55         56      47      0.061910   0.142910     1000
              56         57      48      0.114440   0.264170     1000
              57         58      49      0.283740   0.283310     1000
              58         59      50      0.283740   0.283310     1000
              57         61      51      0.045020   0.103940     1000
              61         62      52      0.026260   0.060630     1000
              62         63      53      0.060030   0.138580     1000
              63         64      54      0.030020   0.069290     1000
              64         65      55      0.020640   0.047640     1000
              62         67      56      0.108810   0.251180     1000
              67         68      57      0.255880   0.134600     1000
              68         69      58      0.416990   0.219340     1000
              69         70      59      0.502280   0.264210     1000
              70         71      60      0.331700   0.174480     1000
              71         72      61      0.208490   0.109670     1000
              56         73      62      0.138820   0.320470     1000
               0         75      63      0.007500   0.017320     1000
              75         76      64      0.270140   0.623620     1000
              76         77      65      0.382700   0.883460     1000
              77         78      66      0.330180   0.762200     1000
              78         80      67      0.328300   0.757870     1000
              80         81      68      0.170720   0.394090     1000
              81         82      69      0.559140   0.294120     1000
              81         83      70      0.058160   0.134250     1000
              83         84      71      0.701300   0.368900     1000
              84         85      72      1.023520   0.538390     1000
              83         86      73      0.067540   0.155910     1000
              86         87      74      1.323520   0.453970     1000
               0        121      75      0.011260   0.025980     1000
             121        122      76      0.729760   1.684640     1000
             122        123      77      0.225120   0.519680     1000
             123        124      78      0.208240   0.480710     1000
             124        125      79      0.046900   0.108270     1000
             125        127      80      0.619500   0.618570     1000
             127        128      81      0.340490   0.339980     1000
             128        129      82      0.568620   0.299110     1000
             128        130      83      0.108770   0.108600     1000
             130        131      84      0.568620   0.299110     1000
               0        133      85      0.011260   0.025980     1000
             133        134      86      0.418350   0.965750     1000
             134        135      87      0.104990   0.136410     1000
             134        136      88      0.438980   1.013380     1000
             136        137      89      0.075200   0.025790     1000
             137        138      90      0.076920   0.177560     1000
             138        139      91      0.332050   0.766530     1000
             139        141      92      0.084420   0.194880     1000
             141        142      93      0.133200   0.307480     1000
             142        143      94      0.293200   0.292760     1000
             143        144      95      0.217530   0.217210     1000
             144        145      96      0.264820   0.264430     1000
             142        146      97      0.103180   0.238190     1000
             146        147      98      0.135070   0.311810     1000
               0        148      99      0.009380   0.021650     1000
             148        149     100      0.168840   0.389760     1000
             149        150     101      0.118190   0.272830     1000
             150        152     102      2.286080   0.784140     1000
             150        153     103      0.455870   1.052360     1000
             153        154     104      0.696000   1.606690     1000
             154        155     105      0.457740   1.056690     1000
             155        156     106      0.202980   0.263730     1000
             156        157     107      0.213480   0.277370     1000
             157        158     108      0.549670   0.289140     1000
             158        159     109      0.540190   0.284150     1000
             157        160     110      0.045500   0.059110     1000
             160        162     111      0.473850   0.249260     1000
             162        163     112      0.862410   0.453640     1000
             163        164     113      0.568620   0.299110     1000
             158        200     114      0.777110   0.408780     1000
             200        201     115      1.080380   0.568300     1000
             159        202     116      1.099330   0.578270     1000
             202        203     117      0.473850   0.249260     1000
             154        204     118      0.322670   0.744880     1000
             204        205     119      0.146330   0.337790     1000
             205        206     120      0.123820   0.285830     1000
               0        207     121      0.011260   0.025980     1000
             207        208     122      0.649100   1.498420     1000
             208        209     123      0.045020   0.103940     1000
             209        210     124      0.526400   0.180560     1000
             209        211     125      0.020640   0.047640     1000
             211        212     126      0.530710   0.279170     1000
             211        214     127      0.097550   0.225200     1000
             214        215     128      0.118190   0.272830     1000
             214        217     129      0.138820   0.320470     1000
             217        218     130      0.043150   0.099610     1000
             218        219     131      0.091920   0.212200     1000
             219        220     132      0.161340   0.372440     1000
             220        221     133      0.378320   0.377750     1000
             221        222     134      0.397240   0.396640     1000
             222        223     135      0.293200   0.292760     1000       
                                     
              7         86      136       0.13132    0.30315     1000
             10         32	    137       0.26536    0.13958     1000
             20        130	    138       0.14187	 0.14166     1000
             46        223	    139       0.08512	 0.08499     1000
             33         61	    140       0.04502	 0.10394     1000
             59        145	    141       0.14187	 0.14166     1000
             65        147	    142       0.14187	 0.14166     1000
             73        206	    143       0.03940	 0.09094     1000
             78        125	    144       0.12944	 0.29882     1000
            125        219	    145       0.01688	 0.03898     1000
            131        223	    146       0.33170	 0.17448     1000     
            139        154	    147       0.14187	 0.14166     1000     
            138        217	    148       0.07692	 0.17756     1000     
            138        153	    149       0.07692	 0.17756     1000     
            141        154	    150       0.07692	 0.17756     1000     
            141        220	    151       0.07692	 0.17756     1000     
            145        206      152       0.26482	 0.26443     1000     
            160         56	    153       0.49696	 0.64567     1000     
            212        122	    154       0.17059    0.08973     1000     
            215        123	    155       0.05253    0.12126     1000     
            223        147	    156       0.29320    0.29276     1000
             ;   
   
#--------------------------------------------------------------------------------  
#fixar a magnitude de tensao da subestaçaoao no valor nominal
fix  { i in Ob: i == Barra_SE}
      Vsqr[i] := Vnom^2;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia ativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   PS[i] := 0;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia reativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   QS[i] := 0;

#--------------------------------------------------------------------------------
#normalizacao e calculo da impedancia ao quadrado

for {(i,j) in Ol} {
let R[i,j] := R[i,j] / 1000;
let X[i,j] := X[i,j] / 1000;
let Z2[i,j] := (R[i,j])^2 + (X[i,j])^2 ;
};

#--------------------------------------------------------------------------------

let Vmax   := Vnom * 1.0;
let Vmin   := Vnom * 0.9581;


# Linearizacao
for{(i,j) in Ol}{
let DS[i,j] := (Vmax * Imax[i,j]) / Y;

for {y in 1..Y}{
let ms[i,j,y] := (2*y-1)*DS[i,j];
}
let ms[i,j,1] := ms[i,j,1] * 5/6;
}

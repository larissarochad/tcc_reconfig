param Vnom := 12.66;
		
param : Ot:   Ki   Si   Ti :=
		1	  1    1.0  1;#8760;	
#-----------------------------------------------------------------------

param : Ob :   Tb      PD            QD            QC:= 
         1     1      0.000000      0.000000      0.000000
		 2     0      0.000000      0.000000      0.000000
		 3     0      0.000000      0.000000      0.000000
		 4     0      0.000000      0.000000      0.000000
		 5     0      0.000000      0.000000      0.000000
		 6     0      2.600000      2.200000      0.000000
		 7     0     40.400000     30.000000      0.000000
		 8     0     75.000000     54.000000      0.000000
		 9     0     30.000000     22.000000      0.000000
		10     0     28.000000     19.000000      0.000000
		11     0    145.000000    104.000000      0.000000
		12     0    145.000000    104.000000      0.000000
		13     0      8.000000      5.500000      0.000000
		14     0      8.000000      5.500000      0.000000
		15     0      0.000000      0.000000      0.000000
		16     0     45.500000     30.000000      0.000000
		17     0     60.000000     35.000000      0.000000
		18     0     60.000000     35.000000      0.000000
		19     0      0.000000      0.000000      0.000000
		20     0      1.000000      0.600000      0.000000
		21     0    114.000000     81.000000      0.000000
		22     0      5.300000      3.500000      0.000000
		23     0      0.000000      0.000000      0.000000
		24     0     28.000000     20.000000      0.000000
		25     0      0.000000      0.000000      0.000000
		26     0     14.000000     10.000000      0.000000
		27     0     14.000000     10.000000      0.000000
		28     0     26.000000     18.600000      0.000000
		29     0     26.000000     18.600000      0.000000
		30     0      0.000000      0.000000      0.000000
		31     0      0.000000      0.000000      0.000000
		32     0      0.000000      0.000000      0.000000
		33     0     14.000000     10.000000      0.000000
		34     0     19.500000     14.000000      0.000000
		35     0      6.000000      4.000000      0.000000
		36     0     26.000000     18.550000      0.000000
		37     0     26.000000     18.550000      0.000000
		38     0      0.000000      0.000000      0.000000
		39     0     24.000000     17.000000      0.000000
		40     0     24.000000     17.000000      0.000000
		41     0      1.200000      1.000000      0.000000
		42     0      0.000000      0.000000      0.000000
		43     0      6.000000      4.300000      0.000000
		44     0      0.000000      0.000000      0.000000
		45     0     39.220000     26.300000      0.000000
		46     0     39.220000     26.300000      0.000000
		47     0      0.000000      0.000000      0.000000
		48     0     79.000000     56.400000      0.000000
		49     0    384.700000    274.500000      0.000000
		50     0    384.700000    274.500000      0.000000
		51     0     40.500000     28.300000      0.000000
		52     0      3.600000      2.700000      0.000000
		53     0      4.350000      3.500000      0.000000
		54     0     26.400000     19.000000      0.000000
		55     0     24.000000     17.200000      0.000000
		56     0      0.000000      0.000000      0.000000
		57     0      0.000000      0.000000      0.000000
		58     0      0.000000      0.000000      0.000000
		59     0    100.000000     72.000000      0.000000
		60     0      0.000000      0.000000      0.000000
		61     0   1244.000000    888.000000      0.000000
		62     0     32.000000     23.000000      0.000000
		63     0      0.000000      0.000000      0.000000
		64     0    227.000000    162.000000      0.000000
		65     0     59.000000     42.000000      0.000000
		66     0     18.000000     13.000000      0.000000
		67     0     18.000000     13.000000      0.000000
		68     0     28.000000     20.000000      0.000000
		69     0     28.000000     20.000000      0.000000;
 
param :     Ol: 	  linea         R           X   	     Imax :=
         1      2        1        0.000500     0.001200      1000
		 2      3        2        0.000500     0.001200      1000
		 3      4        3        0.001500     0.003600      1000
		 4      5        4        0.025100     0.029400      1000
		 5      6        5        0.366000     0.186400      1000
		 6      7        6        0.381100     0.194100      1000
		 7      8        7        0.092200     0.047000      1000
		 8      9        8        0.049300     0.025100      1000
		 9     10        9        0.819000     0.270700      1000
		10     11       10        0.187200     0.061900      1000
		11     12       11        0.711400     0.235100      1000
		12     13       12        1.030000     0.340000      1000
		13     14       13        1.044000     0.340000      1000
		14     15       14        1.058000     0.349600      1000
		15     16       15        0.196600     0.065000      1000
		16     17       16        0.374400     0.123800      1000
		17     18       17        0.004700     0.001600      1000
		18     19       18        0.327600     0.108300      1000
		19     20       19        0.210600     0.069600      1000
		20     21       20        0.341600     0.112900      1000
		21     22       21        0.014000     0.004600      1000
		22     23       22        0.159100     0.052600      1000
		23     24       23        0.346300     0.114500      1000
		24     25       24        0.748800     0.247500      1000
		25     26       25        0.308900     0.102100      1000
		26     27       26        0.173200     0.057200      1000
		 3     28       27        0.004400     0.010800      1000
		28     29       28        0.064000     0.156500      1000
		29     30       29        0.397800     0.135100      1000
		30     31       30        0.070200     0.023200      1000
		31     32       31        0.351000     0.116000      1000
		32     33       32        0.839000     0.281600      1000
		33     34       33        1.708000     0.564600      1000
		34     35       34        1.474000     0.487300      1000
		 3     36       35        0.004400     0.010800      1000
		36     37       36        0.064000     0.156500      1000
		37     38       37        0.105300     0.123000      1000
		38     39       38        0.030400     0.035500      1000
		39     40       39        0.001800     0.002100      1000
		40     41       40        0.728300     0.850900      1000
		41     42       41        0.310000     0.362300      1000
		42     43       42        0.041000     0.047800      1000
		43     44       43        0.009200     0.011600      1000
		44     45       44        0.108900     0.137300      1000
		45     46       45        0.000900     0.001200      1000
		 4     47       46        0.003400     0.008400      1000
		47     48       47        0.085100     0.208300      1000
		48     49       48        0.289800     0.709100      1000
		49     50       49        0.082200     0.201100      1000
		 8     51       50        0.092800     0.047300      1000
		51     52       51        0.331900     0.111400      1000
		 9     53       52        0.174000     0.088600      1000
		53     54       53        0.203000     0.103400      1000
		54     55       54        0.284200     0.144700      1000
		55     56       55        0.281300     0.143300      1000
		56     57       56        1.590000     0.533700      1000
		57     58       57        0.783700     0.263000      1000
		58     59       58        0.304200     0.100600      1000
		59     60       59        0.386100     0.117200      1000
		60     61       60        0.507500     0.255500      1000
		61     62       61        0.097400     0.049600      1000
		62     63       62        0.145000     0.073800      1000
		63     64       63        0.710500     0.361900      1000
		64     65       64        1.041000     0.530200      1000
		11     66       65        0.201200     0.061100      1000
		66     67       66        0.004700     0.001400      1000
		12     68       67        0.739400     0.244400      1000
		68     69       68        0.004700     0.001600      1000
		11     43       69        0.500000     0.500000      1000
		13     21       70        0.500000     0.500000      1000
		15     46       71        1.000000     1.000000      1000
		50     59       72        2.000000     2.000000      1000
		27     65       73        1.000000     1.000000      1000;

#--------------------------------------------------------------------------------		   
# fijar la magnitude del voltaje en la subestacion con el valor nominal 
    fix{i in Ob, t in Ot: Tb[i] == 1}
	    Vsqr[i,t] := Vnom^2;
	
#--------------------------------------------------------------------------------		
# fijar la inyecci n de potencia activa en las barras de carga (y no en la subestacion) 

    fix{i in Ob, t in Ot: Tb[i] == 0}
	    PS[i,t] := 0;

#--------------------------------------------------------------------------------		
# fijar la inyecci n de potencia reactiva en las barras de carga (y no en la subestacion) 

    fix{i in Ob, t in Ot: Tb[i] == 0}
	    QS[i,t] := 0;
	    
#--------------------------------------------------------------------------------		
# Normalizacion y calculo de la impedancia de cada linea

for {(i,j) in Ol} {	
	let R[i,j] := R[i,j] / 1000;
	let X[i,j] := X[i,j] / 1000;
	let Z2[i,j] := (R[i,j])^2 + (X[i,j])^2 ;
};

# unidades

# Voltaje  = kV
# R, X = ohm;

# lei de ohm

#  V(kV) = I(A) x { R(ohm) / 1000 }

#--------------------------------------------------------------------------------
for {i in Ob, t in Ot} {
	let Pd[i,t] := Si[t]*PD[i]; 
	let Qd[i,t] := Si[t]*QD[i];
}	


let Vmax   := Vnom * 1.05;
let Vmin   := Vnom * 0.9;

#-------------------------------------------------
#linealizacion de P^2 y Q^2

let Y:= 100;

for{(i,j) in Ol, t in Ot}{
	let ds[i,j,t] := (Vmax*Imax[i,j])/Y;
	
	for {y in 1..Y}{
	let ms[i,j,t,y] := (2*y-1)*ds[i,j,t];
	}
	let ms[i,j,t,1]:= ms[i,j,t,1]*5/6;
}

#--------------------------------------------------------------------------------

#
let S := 0;

# Numero de barras
let N := 69;

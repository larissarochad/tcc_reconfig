
param Vnom := 12.66;
 param Barra_SE := 1;
     
#-----------------------------------------------------------------------
 
 param		: Ob :		Tb		PD		QD		QC		Vini:=
				1		1		0		0		0		126.600
				2		0		100		60		0		126.224
				3		0		90		40		0		124.440
				4		0		120		80		0		123.493
				5		0		60		30		0		122.556
				6		0		60		20		0		120.227
				7		0		200		100		0		119.785
				8		0		200		100		0		119.172
				9		0		60		20		0		118.379
				10		0		60		20		0		117.642
				11		0		45		30		0		117.533
				12		0		60		35		0		117.344
				13		0		60		35		0		116.570
				14		0		120		80		0		116.283
				15		0		60		10		0		116.104
				16		0		60		20		0		115.931
				17		0		60		20		0		115.674
				18		0		90		40		0		115.597
				19		0		90		40		0		126.157
				20		0		90		40		0		125.704
				21		0		90		40		0		125.615
				22		0		90		40		0		125.535
				23		0		90		50		0		123.986
				24		0		420		200		0		123.141
				25		0		420		200		0		122.720
				26		0		60		25		0		119.982
				27		0		60		25		0		119.658
				28		0		60		20		0		118.210
				29		0		120		70		0		117.169
				30		0		200		600		0		116.719
				31		0		150		70		0		116.192
				32		0		210		100		0		116.076
				33		0		60		40		0		116.040

         ;
         
#-----------------------------------------------------------------------


param :      Ol:    linha         R                X     Imax   L :=    
          1      2       1       0.22140      0.268    380.0000   0.4164
          2      3       2       0.22140      0.268    380.0000   2.2267
          3      4       3       0.45650      0.353    250.0000   0.8018
          4      5       4       0.45650      0.353    250.0000   0.8348
          5      6       5       0.45650      0.353    250.0000   1.7941
          6      7       6       1.37400      0.355    120.0000   0.1362
          7      8       7       1.37400      0.355    120.0000   0.5178
          8      9       8       1.37400      0.355    120.0000   0.7496
          9     10       9       1.37400      0.355    120.0000   0.7598
         10     11      10       1.37400      0.355    120.0000   0.1431
         11     12      11       1.37400      0.355    120.0000   0.2725
         12     13      12       1.37400      0.355    120.0000   1.0684
         13     14      13       1.37400      0.355    120.0000   0.3942
         14     15      14       1.37400      0.355    120.0000   0.4301
         15     16      15       1.37400      0.355    120.0000   0.5432
         16     17      16       1.37400      0.355    120.0000   0.9381
         17     18      17       1.37400      0.355    120.0000   0.5328
          2     19      18       2.71800      0.374     70.0000   0.0603
         19     20      19       2.71800      0.374     70.0000   0.5534
         20     21      20       2.71800      0.374     70.0000   0.1507
         21     22      21       2.71800      0.374     70.0000   0.2608
          3     23      22       1.37400      0.355    120.0000   0.3284
         23     24      23       1.37400      0.355    120.0000   0.6536
         24     25      24       1.37400      0.355    120.0000   0.6521
          6     26      25       1.37400      0.355    120.0000   0.1477
         26     27      26       1.37400      0.355    120.0000   0.2068
         27     28      27       1.37400      0.355    120.0000   0.7707
         28     29      28       1.37400      0.355    120.0000   0.5853
         29     30      29       1.37400      0.355    120.0000   0.3694
         30     31      30       1.37400      0.355    120.0000   0.7092
         31     32      31       1.37400      0.355    120.0000   0.2260
         32     33      32       1.37400      0.355    120.0000   0.2482
         
          8     21      33       1.37400      0.355    120.0000   1.4556
          9     15      34       1.37400      0.355    120.0000   1.4556
         12     22      35       1.37400      0.355    120.0000   1.4556
         18     33      36       1.37400      0.355    120.0000   0.3639
         25     29      37       1.37400      0.355    120.0000   0.3639  
 ;

#--------------------------------------------------------------------------------  
#fixar a magnitude de tensao da subestaçaoao no valor nominal
fix  { i in Ob: i == Barra_SE}
      Vsqr[i] := Vnom^2;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia ativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   PS[i] := 0;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia reativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   QS[i] := 0;

#--------------------------------------------------------------------------------
#normalizacao e calculo da impedancia ao quadrado

for {(i,j) in Ol} {
let R[i,j] := R[i,j] * L[i,j] / 1000;
let X[i,j] := X[i,j] * L[i,j] / 1000;
let Z2[i,j] := (R[i,j])^2 + (X[i,j])^2 ;
};

#--------------------------------------------------------------------------------

let Vmax   := Vnom * 1.0;
let Vmin   := Vnom * 0.9254;

let Y:= 50;

# Linearizacao
for{(i,j) in Ol}{
let DS[i,j] := (Vmax * Imax[i,j]) / Y;

for {y in 1..Y}{
let ms[i,j,y] := (2*y-1)*DS[i,j];
}
let ms[i,j,1] := ms[i,j,1] * 5/6;
}


let S := 0;

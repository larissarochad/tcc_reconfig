
param Vnom := 11;
param Barra_SE := 0;
     
#--------------------------------------------------------------------

param    :Ob:  Tb         PD          QD         QC:=  
		0		1		  0		      0		    0.000
		1		0		  0		      0		    0.000
		2		0		133.84		101.14		0.000
		3		0		16.214		11.292		0.000
		4		0		34.315		21.845		0.000
		5		0		73.016		63.602		0.000
		6		0		144.2		68.604		0.000
		7		0		104.47		61.725		0.000
		8		0		28.547		11.503		0.000
		9		0		87.56		51.073		0.000
		10		0		198.2		106.77		0.000
		11		0		146.8		75.995		0.000
		12		0		26.04		18.687		0.000
		13		0		52.1		23.22		0.000
		14		0		141.9		117.5		0.000
		15		0		21.87		28.79		0.000
		16		0		33.37		26.45		0.000
		17		0		32.43		25.23		0.000
		18		0		20.234		11.906		0.000
		19		0		156.94		78.523		0.000
		20		0		546.29		351.4		0.000
		21		0		180.31		164.2		0.000
		22		0		93.167		54.594		0.000
		23		0		85.18		39.65		0.000
		24		0		168.1		95.178		0.000
		25		0		125.11		150.22		0.000
		26		0		16.03		24.62		0.000
		27		0		26.03		24.62		0.000
		29		0		594.56		522.62		0.000
		30		0		120.62		59.117		0.000
		31		0		102.38		99.554		0.000
		32		0		513.4		318.5		0.000
		33		0		475.25		456.14		0.000
		34		0		151.43		136.79		0.000
		35		0		205.38		83.302		0.000
		36		0		131.6		93.082		0.000
		37		0		448.4		369.79		0.000
		38		0		440.52		321.64		0.000
		40		0		112.54		55.134		0.000
		41		0		53.963		38.998		0.000
		42		0		393.05		342.6		0.000
		43		0		326.74		278.56		0.000
		44		0		536.26		240.24		0.000
		45		0		76.247		66.562		0.000
		46		0		53.52		39.76		0.000
		47		0		40.328		31.964		0.000
		48		0		39.653		20.758		0.000
		49		0		66.195		42.361		0.000
		50		0		73.904		51.653		0.000
		51		0		114.77		57.965		0.000
		52		0		918.37		1205.1		0.000
		53		0		210.3		146.66		0.000
		54		0		66.68		56.608		0.000
		55		0		42.207		40.184		0.000
		56		0		433.74		283.41		0.000
		58		0		62.1		26.86		0.000
		59		0		92.46		88.38		0.000
		60		0		85.188		55.436		0.000
		61		0		345.3		332.4		0.000
		62		0		22.5		16.83		0.000
		63		0		80.551		49.156		0.000
		64		0		95.86		90.758		0.000
		65		0		62.92		47.7		0.000
		66		0		478.8		463.74		0.000
		67		0		120.94		52.006		0.000
		68		0		139.11		100.34		0.000
		69		0		391.78		193.5		0.000
		70		0		27.741		26.713		0.000
		71		0		52.814		25.257		0.000
		72		0		66.89		38.713		0.000
		73		0		467.5		395.14		0.000
		74		0		594.85		239.74		0.000
		75		0		132.5		84.363		0.000
		76		0		52.699		22.482		0.000
		77		0		869.79		614.775		0.000
		78		0		31.349		29.817		0.000
		79		0		192.39		122.43		0.000
		80		0		65.75		45.37		0.000
		81		0		238.15		223.22		0.000
		82		0		294.55		162.47		0.000
		83		0		485.57		437.92		0.000
		84		0		243.53		183.03		0.000
		85		0		243.53		183.03		0.000
		86		0		134.25		119.29		0.000
		87		0		22.71		27.96		0.000
		88		0		49.513		26.515		0.000
		89		0		383.78		257.16		0.000
		90		0		49.64		20.6		0.000
		91		0		22.473		11.806		0.000
		93		0		62.93		42.96		0.000
		94		0		30.67		34.93		0.000
		95		0		62.53		66.79		0.000
		96		0		114.57		81.748		0.000
		97		0		81.292		66.526		0.000
		98		0		31.733		15.96		0.000
		99		0		33.32		60.48		0.000
		100		0		531.28		224.85		0.000
		101		0		507.03		367.42		0.000
		102		0		26.39		11.7		0.000
		103		0		45.99		30.392		0.000
		105		0		100.66		47.572		0.000
		106		0		456.48		350.3		0.000
		107		0		522.56		449.29		0.000
		108		0		408.43		168.46		0.000
		109		0		141.48		134.25		0.000
		110		0		104.43		66.024		0.000
		111		0		96.793		83.647		0.000
		112		0		493.92		419.34		0.000
		113		0		225.38		135.88		0.000
		114		0		509.21		387.21		0.000
		115		0		188.5		173.46		0.000
		116		0		918.03		898.55		0.00
		117		0		305.08		215.37		0.000
		118		0		54.38		40.97		0.000
		119		0		211.14		192.9		0.000
		120		0		67.009		53.336		0.000
		121		0		162.07		90.321		0.000
		122		0		48.785		29.156		0.000
		123		0		33.9		18.98		0.000;

#-----------------------------------------------------------
param :   Ol: 	  linha   	  R			  X			Imax:=
		0	1		1		   0		   0		3000
		1	2		2		0.0360		0.0130		3000
		2	3		3		0.0330		0.0119		3000
		2	4		4		0.0450		0.0162		3000
		4	5		5		0.0150		0.0540		3000
		5	6		6		0.0150		0.0540		3000
		6	7		7		0.0150		0.0125		3000
		7	8		8		0.0180		0.0140		3000
		8	9		9		0.0210		0.0630		3000
		2	10		10		0.1660		0.1344		3000
		10	11		11		0.1120		0.0789		3000
		11	12		12		0.1870		0.3130		3000
		12	13		13		0.1420		0.1512		3000
		13	14		14		0.1800		0.1180		3000
		14	15		15		0.1500		0.0450		3000
		15	16		16		0.1600		0.1800		3000
		16	17		17		0.1570		0.1710		3000
		11	18		18		0.2180		0.2850		3000
		18	19		19		0.1180		0.1850		3000
		19	20		20		0.1600		0.1960		3000
		20	21		21		0.1200		0.1890		3000
		21	22		22		0.1200		0.0789		3000
		22	23		23		14.100		0.7230		3000
		23	24		24		0.2930		0.1348		3000
		24	25		25		0.1330		0.1040		3000
		25	26		26		0.1780		0.1340		3000
		26	27		27		0.1780		0.1340		3000
		4	29		28		0.0150		0.0296		3000
		29	30		29		0.0120		0.0276		3000
		30	31		30		0.1200		0.2766		3000
		31	32		31		0.2100		0.2430		3000
		32	33		32		0.1200		0.0540		3000
		33	34		33		0.1780		0.2340		3000
		34	35		34		0.1780		0.2340		3000
		35	36		35		0.1540		0.1620		3000
		31	37		36		0.1870		0.2610		3000
		37	38		37		0.1330		0.0990		3000
		30	40		38		0.3300		0.1940		3000
		40	41		39		0.3100		0.1940		3000
		41	42		40		0.1300		0.1940		3000
		42	43		41		0.2800		0.1500		3000
		43	44		42		11.800		0.8500		3000
		44	45		43		0.4200		0.2436		3000
		45	46		44		0.3000		0.0972		3000
		46	47		45		0.3390		0.1221		3000
		47	48		46		0.3000		0.1779		3000
		36	49		47		0.2100		0.1383		3000
		49	50		48		0.1200		0.0789		3000
		50	51		49		0.1500		0.0987		3000
		51	52		50		0.1500		0.0987		3000
		52	53		51		0.2400		0.1581		3000
		53	54		52		0.1200		0.0789		3000
		54	55		53		0.4050		0.1458		3000
		54	56		54		0.4050		0.1458		3000
		30	58		55		0.3910		0.1410		3000
		58	59		56		0.4060		0.1461		3000
		59	60		57		0.4060		0.1461		3000
		60	61		58		0.7060		0.5461		3000
		61	62		59		0.3380		0.1218		3000
		62	63		60		0.3380		0.1218		3000
		63	64		61		0.2070		0.0747		3000
		64	65		62		0.2470		0.8922		3000
		1	66		63		0.0280		0.0418		3000
		66	67		64		0.1170		0.2016		3000
		67	68		65		0.2550		0.0918		3000
		68	69		66		0.2100		0.0759		3000
		69	70		67		0.3830		0.1380		3000
		70	71		68		0.5040		0.3303		3000
		71	72		69		0.4060		0.1461		3000
		72	73		70		0.9620		0.7610		3000
		73	74		71		0.1650		0.0600		3000
		74	75		72		0.3030		0.1092		3000
		75	76		73		0.3030		0.1092		3000
		76	77		74		0.2060		0.1440		3000
		77	78		75		0.2330		0.0840		3000
		78	79		76		0.5910		0.1773		3000
		79	80		77		0.1260		0.0453		3000
		67	81		78		0.5590		0.3687		3000
		81	82		79		0.1860		0.1227		3000
		82	83		80		0.1860		0.1227		3000
		83	84		81		0.3000		0.1390		3000
		84	85		82		0.1540		0.1480		3000
		85	86		83		0.2300		0.1280		3000
		86	87		84		0.2520		0.1060		3000
		87	88		85		0.1800		0.1480		3000
		82	89		86		0.1600		0.1820		3000
		89	90		87		0.3000		0.2300		3000
		90	91		88		0.1600		0.3930		3000
		68	93		89		0.6690		0.2412		3000
		93	94		90		0.2660		0.1227		3000
		94	95		91		0.2660		0.1227		3000
		95	96		92		0.2660		0.1227		3000
		96	97		93		0.2660		0.1227		3000
		97	98		94		0.2330		0.1150		3000
		98	99		95		0.4960		0.1380		3000
		95	100		96		0.1960		0.1800		3000
		100	101		97		0.1960		0.1800		3000
		101	102		98		0.1866		0.1220		3000
		102	103		99		0.0746		0.3180		3000
		1	105		100		0.0625		0.0265		3000
		105	106		101		0.1501		0.2340		3000
		106	107		102		0.1347		0.0888		3000
		107	108		103		0.2307		0.1203		3000
		108	109		104		0.4470		0.1608		3000
		109	110		105		0.1632		0.0588		3000
		110	111		106		0.3300		0.0990		3000
		111	112		107		0.1560		0.0561		3000
		112	113		108		0.3819		0.1374		3000
		113	114		109		0.1626		0.0585		3000
		114	115		110		0.3819		0.1374		3000
		115	116		111		0.2445		0.0879		3000
		115	117		112		0.2088		0.0753		3000
		117	118		113		0.2301		0.0828		3000
		105	119		114		0.6102		0.2196		3000
		119	120		115		0.1866		0.1270		3000
		120	121		116		0.3732		0.2460		3000
		121	122		117		0.4050		0.3670		3000
		122	123		118		0.4890		0.4380		3000
											
		48	27		119		0.5258		0.2925		3000
		17	27		120		0.5258		0.2916		3000
		8	24		121		0.4272		0.1539		3000
		56	45		122		0.4800		0.1728		3000
		65	56		123		0.3600		0.1296		3000
		38	65		124		0.5700		0.5720		3000
		9	42		125		0.5300		0.3348		3000
		61	100		126		0.3957		0.1425		3000
		76	95		127		0.6800		0.6480		3000
		91	78		128		0.4062		0.1464		3000
		103	80		129		0.4626		0.1674		3000
		113	86		130		0.6510		0.2340		3000
		110	89		131		0.8125		0.2925		3000
		115	123		132		0.7089		0.2553		3000
		25	36		133		0.5000		0.5000		3000;
#--------------------------------------------------------------------------------  
#fixar a magnitude de tensao da subestaçaoao no valor nominal
fix  { i in Ob: i == Barra_SE}
      Vsqr[i] := Vnom^2;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia ativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   PS[i] := 0;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia reativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   QS[i] := 0;

#--------------------------------------------------------------------------------
#normalizacao e calculo da impedancia ao quadrado

for {(i,j) in Ol} {
let R[i,j] := R[i,j] / 1000;
let X[i,j] := X[i,j] / 1000;
let Z2[i,j] := (R[i,j])^2 + (X[i,j])^2 ;
};

#--------------------------------------------------------------------------------

let Vmax   := Vnom * 1.0;
let Vmin   := Vnom * 0.9321;


let Y:= 100;

# Linearizacao
for{(i,j) in Ol}{
let DS[i,j] := (Vmax * Imax[i,j]) / Y;

for {y in 1..Y}{
let ms[i,j,y] := (2*y-1)*DS[i,j];
}
let ms[i,j,1] := ms[i,j,1] * 5/6;
}


let S := 5;


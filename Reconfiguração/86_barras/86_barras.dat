
param Vnom := 11.4;

param Barra_SE := 0; 

          
#----------------------------------------------------------------------- 

param :        Ob :        PD       QD     QC     Vini:=
               0           0.0      0.0     0    11.4000
               1           0.0      0.0     0    11.2683
               2         100.0     50.0     0    11.1662
               3         300.0    200.0     0    11.0560
               4         350.0    250.0     0    11.0191
               5         220.0    100.0     0    10.9514
               6        1100.0    800.0     0    10.9415
               7         400.0    320.0     0    10.9121
               8         300.0    200.0     0    10.9053
               9         300.0    230.0     0    10.8954
               10        300.0    260.0     0    10.9041
               11          0.9      0.0     0    11.3642
               12       1200.0    800.0     0    11.2102
               13        800.0    600.0     0    10.9895
               14        700.0    500.0     0    11.1980
               15          0.0      0.0     0    11.2541
               16        300.0    150.0     0    11.2063
               17        500.0    350.0     0    11.1613
               18        700.0    400.0     0    11.0438
               19       1200.0   1000.0     0    11.0199
               20        300.0    300.0     0    10.9666
               21        400.0    350.0     0    10.9370
               22         50.0     20.0     0    10.9357
               23         50.0     20.0     0    10.9341
               24         50.0     10.0     0    10.9333
               25         50.0     30.0     0    11.3596
               26        100.0     60.0     0    11.3070
               27        100.0     70.0     0    11.1872
               28       1800.0   1300.0     0    11.1563
               29        200.0    120.0     0    11.1487
               30          0.0      0.0     0    11.2960
               31       1800.0   1600.0     0    11.2259
               32        200.0    150.0     0    11.2153
               33        200.0    100.0     0    11.2143
               34        800.0    600.0     0    11.1916
               35        100.0     60.0     0    11.1867
               36        100.0     60.0     0    11.1494
               37         20.0     10.0     0    11.1473
               38         20.0     10.0     0    11.1453
               39         20.0     10.0     0    11.1474
               40         20.0     10.0     0    11.1445
               41        200.0    160.0     0    11.1359
               42         50.0     30.0     0    11.1425
               43          0.0      0.0     0    11.3638
               44         30.0     20.0     0    11.3431
               45        800.0    700.0     0    11.2748
               46        200.0    150.0     0    11.1989
               47          0.0      0.0     0    11.1504
               48          0.0      0.0     0    11.1023
               49          0.0      0.0     0    11.0544
               50        200.0    160.0     0    11.0256
               51        800.0    600.0     0    10.9719
               52        500.0    300.0     0    10.9524
               53        500.0    350.0     0    10.9214
               54        500.0    300.0     0    10.9160
               55        200.0     80.0     0    10.9470
               56          0.0      0.0     0    11.2531
               57         30.0     20.0     0    11.0068
               58        600.0    420.0     0    10.9832
               59          0.0      0.0     0    10.9651
               60         20.0     10.0     0    10.9527
               61         20.0     10.0     0    10.9526
               62        200.0    130.0     0    10.9003
               63        300.0    240.0     0    10.9104
               64        300.0    200.0     0    10.9143
               65          0.0      0.0     0    11.3595
               66         50.0     30.0     0    11.2593
               67          0.0      0.0     0    11.1604
               68        400.0    360.0     0    10.9833
               69          0.0      0.0     0    10.9513
               70          0.0      0.0     0    10.9035
               71       2000.0   1500.0     0    10.8663
               72        200.0    150.0     0    11.1947
               73          0.0      0.0     0    11.1573
               74          0.0      0.0     0    11.1332
               75       1200.0    950.0     0    11.0910
               76        300.0    180.0     0    11.0744
               77          0.0      0.0     0    11.1521
               78        400.0    360.0     0    11.0255
               79       2000.0   1300.0     0    10.9854
               80        200.0    140.0     0    10.9630
               81        500.0    360.0     0    10.9464
               82        100.0     30.0     0    10.9451
               83        400.0    360.0     0    10.9584
               ;
         

#----------------------------------------------------------------------- 

param :       Ol:       linha       R        X        Imax:=
           0       1       1     0.1944      0.6624     1000
           1       2       2     0.2096      0.4304     1000
           2       3       3     0.2358      0.4842     1000
           3       4       4     0.0917      0.1883     1000
           4       5       5     0.2096      0.4304     1000
           5       6       6     0.0393      0.0807     1000
           6       7       7     0.0405      0.1380     1000
           7       8       8     0.1048      0.2152     1000
           7       9       9     0.2358      0.4842     1000
           7      10      10     0.1048      0.2152     1000
          0       11      11     0.0786      0.1614     1000
          11      12      12     0.3406      0.6944     1000
          12      13      13     0.0262      0.0538     1000
          12      14      14     0.0786      0.1614     1000
          0       15      15     0.1134      0.3864     1000
          15      16      16     0.0524      0.1076     1000
          16      17      17     0.0524      0.1076     1000
          17      18      18     0.1572      0.3228     1000
          18      19      19     0.0393      0.0807     1000
          19      20      20     0.1703      0.3497     1000
          20      21      21     0.2358      0.4842     1000
          21      22      22     0.1572      0.3228     1000
          21      23      23     0.1965      0.4035     1000
          23      24      24     0.1310      0.2690     1000
          0       25      25     0.0567      0.1932     1000
          25      26      26     0.1048      0.2152     1000
          26      27      27     0.2489      0.5111     1000
          27      28      28     0.0486      0.1656     1000
          28      29      29     0.1310      0.2690     1000
          0       30      30     0.1965      0.3960     1000
          30      31      31     0.1310      0.2690     1000
          31      32      32     0.1310      0.2690     1000
          32      33      33     0.0262      0.0538     1000
          33      34      34     0.1703      0.3497     1000
          34      35      35     0.0524      0.1076     1000
          35      36      36     0.4978      1.0222     1000
          36      37      37     0.0393      0.0807     1000
          37      38      38     0.0393      0.0807     1000
          38      39      39     0.0786      0.1614     1000
          39      40      40     0.2096      0.4304     1000
          38      41      41     0.1965      0.4035     1000
          41      42      42     0.2096      0.4304     1000
          0       43      43     0.0486      0.1656     1000
          43      44      44     0.0393      0.0807     1000
          44      45      45     0.1310      0.2690     1000
          45      46      46     0.2358      0.4842     1000
          0       47      47     0.2430      0.8280     1000
          47      48      48     0.0655      0.1345     1000
          48      49      49     0.0655      0.1345     1000
          49      50      50     0.0393      0.0807     1000
          50      51      51     0.0786      0.1614     1000
          51      52      52     0.0393      0.0807     1000
          52      53      53     0.0786      0.1614     1000
          53      54      54     0.0524      0.1076     1000
          54      55      55     0.1310      0.2690     1000
          0       56      56     0.2268      0.7728     1000
          56      57      57     0.5371      1.1029     1000
          57      58      58     0.0524      0.1076     1000
          58      59      59     0.0405      0.1380     1000
          59      60      60     0.0393      0.0807     1000
          60      61      61     0.0262      0.0538     1000
          61      62      62     0.1048      0.2152     1000
          62      63      63     0.2358      0.4842     1000
          63      64      64     0.0243      0.0828     1000
          0       65      65     0.0486      0.1656     1000
          65      66      66     0.1703      0.3497     1000
          66      67      67     0.1215      0.4140     1000
          67      68      68     0.2187      0.7452     1000
          68      69      69     0.0486      0.1656     1000
          69      70      70     0.0729      0.2484     1000
          70      71      71     0.0567      0.1932     1000
          71      72      72     0.0262      0.0528     1000
          0       73      73     0.3240      1.1040     1000
          73      74      74     0.0324      0.1104     1000
          74      75      75     0.0567      0.1932     1000
          75      76      76     0.0486      0.1656     1000
          0       77      77     0.2511      0.8556     1000
          77      78      78     0.1296      0.4416     1000
          78      79      79     0.0486      0.1656     1000
          79      80      80     0.1310      0.2640     1000
          80      81      81     0.1310      0.2640     1000
          81      82      82     0.0917      0.1883     1000
          82      83      83     0.3144      0.6456     1000
          
           5      55      84     0.1310      0.2690     1000
           7      60      85     0.1310      0.2690     1000
          11      43      86     0.1310      0.2690     1000
          12      72      87     0.3406      0.6994     1000
          13      76      88     0.4585      0.9415     1000
          14      18      89     0.5371      1.0824     1000
          16      26      90     0.0917      0.1883     1000
          20      83      91     0.0786      0.1614     1000
          28      32      92     0.0524      0.1076     1000
          29      39      93     0.0786      0.1614     1000
          34      46      94     0.0262      0.0538     1000
          40      42      95     0.1965      0.4035     1000
          53      64      96     0.0393      0.0807     1000
          ;
             
#--------------------------------------------------------------------------------		   
#fixar a magnitude de tensao da subestaçaoao no valor nominal
fix  { i in Ob: i == Barra_SE}
      Vsqr[i] := Vnom^2;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia ativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   PS[i] := 0;

#--------------------------------------------------------------------------------
#fixar a injecao de potencia reativa no no de carga igual a zero
    fix  {i in Ob: i != Barra_SE }
   QS[i] := 0;

#--------------------------------------------------------------------------------
#normalizacao e calculo da impedancia ao quadrado

for {(i,j) in Ol} {
let R[i,j] := R[i,j] / 1000;
let X[i,j] := X[i,j] / 1000;
let Z2[i,j] := (R[i,j])^2 + (X[i,j])^2 ;
};

#--------------------------------------------------------------------------------

let Vmax   := Vnom * 1.0;
let Vmin   := Vnom * 0.9285;


# Linearizacao
for{(i,j) in Ol}{
let DS[i,j] := (Vmax * Imax[i,j]) / Y;

for {y in 1..Y}{
let ms[i,j,y] := (2*y-1)*DS[i,j];
}
let ms[i,j,1] := ms[i,j,1] * 5/6;
}
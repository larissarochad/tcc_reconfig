param Vnom := 12.660;
param Barra_SE := 1; 

#-----------------------------------------------------------------------

param : Ob :          PD          QD     QC:=  
    1    0.000000     0.000000     0.000000
    2    0.000000     0.000000     0.000000
    3    0.000000     0.000000     0.000000
    4    0.000000     0.000000     0.000000
    5    0.000000     0.000000     0.000000
    6    2.600000     2.200000     0.000000
    7   40.400000    30.000000     0.000000
    8   75.000000    54.000000     0.000000
    9   30.000000    22.000000     0.000000
   10   28.000000    19.000000     0.000000
   11  145.000000   104.000000     0.000000
   12  145.000000   104.000000     0.000000
   13    8.000000     5.500000     0.000000
   14    8.000000     5.500000     0.000000
   15    0.000000     0.000000     0.000000
   16   45.500000    30.000000     0.000000
   17   60.000000    35.000000     0.000000
   18   60.000000    35.000000     0.000000
   19    0.000000     0.000000     0.000000
   20    1.000000     0.600000     0.000000
   21  114.000000    81.000000     0.000000
   22    5.300000     3.500000     0.000000
   23    0.000000     0.000000     0.000000
   24   28.000000    20.000000     0.000000
   25    0.000000     0.000000     0.000000
   26   14.000000    10.000000     0.000000
   27   14.000000    10.000000     0.000000
   28   26.000000    18.600000     0.000000
   29   26.000000    18.600000     0.000000
   30    0.000000     0.000000     0.000000
   31    0.000000     0.000000     0.000000
   32    0.000000     0.000000     0.000000
   33   14.000000    10.000000     0.000000
   34   19.500000    14.000000     0.000000
   35    6.000000     4.000000     0.000000
   36   26.000000    18.550000     0.000000
   37   26.000000    18.550000     0.000000
   38    0.000000     0.000000     0.000000
   39   24.000000    17.000000     0.000000
   40   24.000000    17.000000     0.000000
   41    1.200000     1.000000     0.000000
   42    0.000000     0.000000     0.000000
   43    6.000000     4.300000     0.000000
   44    0.000000     0.000000     0.000000
   45   39.220000    26.300000     0.000000
   46   39.220000    26.300000     0.000000
   47    0.000000     0.000000     0.000000
   48   79.000000    56.400000     0.000000
   49  384.700000   274.500000     0.000000
   50  384.700000   274.500000     0.000000
   51   40.500000    28.300000     0.000000
   52    3.600000     2.700000     0.000000
   53    4.350000     3.500000     0.000000
   54   26.400000    19.000000     0.000000
   55   24.000000    17.200000     0.000000
   56    0.000000     0.000000     0.000000
   57    0.000000     0.000000     0.000000
   58    0.000000     0.000000     0.000000
   59  100.000000    72.000000     0.000000
   60    0.000000     0.000000     0.000000
   61 1244.000000   888.000000     0.000000
   62   32.000000    23.000000     0.000000
   63    0.000000     0.000000     0.000000
   64  227.000000   162.000000     0.000000
   65   59.000000    42.000000     0.000000
   66   18.000000    13.000000     0.000000
   67   18.000000    13.000000     0.000000
   68   28.000000    20.000000     0.000000
   69   28.000000    20.000000     0.000000  ;
         
	
#-----------------------------------------------------------------------
# original

param :     Ol:    linha       R        X        Imax:=
          1    2      1     0.0005   0.0012     1000
          2    3      2     0.0005   0.0012     1000
          3    4      3     0.0015   0.0036     1000
          4    5      4     0.0251   0.0294     1000
          5    6      5     0.3660   0.1864     1000
          6    7      6     0.3811   0.1941     1000
          7    8      7     0.0922   0.0470     1000
          8    9      8     0.0493   0.0251     1000
          9   10      9     0.8190   0.2707     1000
         10   11     10     0.1872   0.0619     1000
         11   12     11     0.7114   0.2351     1000
         12   13     12     1.0300   0.3400     1000
         13   14     13     1.0440   0.3400     1000
         14   15     14     1.0580   0.3496     1000
         15   16     15     0.1966   0.0650     1000
         16   17     16     0.3744   0.1238     1000
         17   18     17     0.0047   0.0016     1000
         18   19     18     0.3276   0.1083     1000
         19   20     19     0.2106   0.0696     1000
         20   21     20     0.3416   0.1129     1000
         21   22     21     0.0140   0.0046     1000
         22   23     22     0.1591   0.0526     1000
         23   24     23     0.3463   0.1145     1000
         24   25     24     0.7488   0.2475     1000
         25   26     25     0.3089   0.1021     1000
         26   27     26     0.1732   0.0572     1000
         3    28     27     0.0044   0.0108     1000
         28   29     28     0.0640   0.1565     1000
         29   30     29     0.3978   0.1351     1000
         30   31     30     0.0702   0.0232     1000
         31   32     31     0.3510   0.1160     1000
         32   33     32     0.8390   0.2816     1000
         33   34     33     1.7080   0.5646     1000
         34   35     34     1.4740   0.4873     1000
         3    36     35     0.0044   0.0108     1000
         36   37     36     0.0640   0.1565     1000
         37   38     37     0.1053   0.1230     1000
         38   39     38     0.0304   0.0355     1000
         39   40     39     0.0018   0.0021     1000
         40   41     40     0.7283   0.8509     1000
         41   42     41     0.3100   0.3623     1000
         42   43     42     0.0410   0.0478     1000
         43   44     43     0.0092   0.0116     1000
         44   45     44     0.1089   0.1373     1000
         45   46     45     0.0009   0.0012     1000
         4    47     46     0.0034   0.0084     1000
         47   48     47     0.0851   0.2083     1000
         48   49     48     0.2898   0.7091     1000
         49   50     49     0.0822   0.2011     1000
         8    51     50     0.0928   0.0473     1000
         51   52     51     0.3319   0.1114     1000
         9    53     52     0.1740   0.0886     1000
         53   54     53     0.2030   0.1034     1000
         54   55     54     0.2842   0.1447     1000
         55   56     55     0.2813   0.1433     1000
         56   57     56     1.5900   0.5337     1000
         57   58     57     0.7837   0.2630     1000
         58   59     58     0.3042   0.1006     1000
         59   60     59     0.3861   0.1172     1000
         60   61     60     0.5075   0.2555     1000
         61   62     61     0.0974   0.0496     1000
         62   63     62     0.1450   0.0738     1000
         63   64     63     0.7105   0.3619     1000
         64   65     64     1.0410   0.5302     1000
         11   66     65     0.2012   0.0611     1000
         66   67     66     0.0047   0.0014     1000
         12   68     67     0.7394   0.2444     1000
         68   69     68     0.0047   0.0016     1000
          
              
 ;


#--------------------------------------------------------------------------------		   
#fixar a magnitude de tensao da subestaçaoao no valor nominal 
fix  { i in Ob: i == Barra_SE}
      Vsqr[i] := Vnom^2;
	
#--------------------------------------------------------------------------------		
#fixar a injecao de potencia ativa no no de carga igual a zero 
    fix  {i in Ob: i != Barra_SE }
	    PS[i] := 0;

#--------------------------------------------------------------------------------		
#fixar a injecao de potencia reativa no no de carga igual a zero 
    fix  {i in Ob: i != Barra_SE }
	    QS[i] := 0;
		
#--------------------------------------------------------------------------------		
#normalizacao e calculo da impedancia ao quadrado

for {(i,j) in Ol} {	
	let R[i,j] := R[i,j]  / 1000;
	let X[i,j] := X[i,j]   / 1000;
	let Z2[i,j] := R[i,j]^2 + X[i,j]^2 ;
};

#--------------------------------------------------------------------------------

let Vmax   := Vnom * 1.0;
let Vmin   := Vnom * 0.9092;

#--------------------------------------------------------------------------------

# Linearizacao
for{(i,j) in Ol}{
	let DS[i,j] := (Vmax * Imax[i,j]) / Y;

	for {y in 1..Y}{
		let ms[i,j,y] := (2*y-1)*DS[i,j];
	}
	let ms[i,j,1] := ms[i,j,1] * 5/6;
}